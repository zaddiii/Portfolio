


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ashes of Tomorrow — Complete</title>
<style>
  :root{
    --bg:#070708; --panel:#0f0f12; --muted:#bdbdbd; --accent:#1a73e8; --good:#2ecc71; --bad:#ff6b6b;
  }
  html,body{height:100%; margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{
    background:linear-gradient(180deg,var(--bg),#050506); color:#eaeaea; padding:20px; display:flex; align-items:flex-start; justify-content:center;
  }
  .wrap{width:980px; max-width:98vw; display:grid; grid-template-columns:1fr 320px; gap:18px;}
  header{grid-column:1/-1; display:flex; align-items:center; justify-content:space-between; gap:12px}
  h1{margin:0; font-size:20px; letter-spacing:0.6px}
  #stats{display:flex; gap:8px; align-items:center}
  .stat{background:var(--panel); padding:8px 10px; border-radius:8px; min-width:90px; text-align:center; box-shadow:0 6px 18px rgba(0,0,0,0.6)}
  .panel{background:var(--panel); padding:12px; border-radius:10px; box-shadow: 0 10px 30px rgba(0,0,0,0.6)}
  #main{min-height:420px; display:flex; flex-direction:column; gap:12px; padding:18px}
  #storyBox{white-space:pre-wrap; min-height:260px; max-height:60vh; overflow:auto; padding:12px; border-radius:8px; background:rgba(255,255,255,0.02)}
  .choices{display:flex; flex-direction:column; gap:8px}
  .choiceBtn{background:var(--accent); color:white; border:0; padding:10px 12px; border-radius:8px; cursor:pointer; font-weight:700; text-align:left}
  .choiceBtn.secondary{background:#444}
  .small{font-size:13px; color:var(--muted)}
  #log{max-height:36vh; overflow:auto; padding:10px; border-radius:8px; background:#050506}
  .bar{height:8px; background:#222; border-radius:999px; overflow:hidden; margin-top:6px}
  .bar > i{display:block; height:100%; background:linear-gradient(90deg,#ffb86b,#ff6b6b); width:0%}
  .row{display:flex; gap:8px; align-items:center}
  .top-actions{display:flex; gap:8px; align-items:center}
  button#startBtn, button#saveBtn, button#loadBtn, button#restartBtn{padding:10px 14px; border-radius:8px; border:0; cursor:pointer; font-weight:700}
  button#startBtn{background:var(--good); color:#032}
  button#restartBtn{background:#666; color:#fff}
  .inventory{display:flex; gap:6px; flex-wrap:wrap}
  .item{background:#071018; border-radius:6px; padding:6px 8px; font-size:13px; color:var(--muted)}
  footer{grid-column:1/-1; color:#9e9e9e; margin-top:8px}
  @media(max-width:920px){.wrap{grid-template-columns:1fr} .panel{order:2}}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Ashes of Tomorrow</h1>
      <div id="stats" aria-live="polite">
        <div class="stat">Food: <span id="statFood">0</span></div>
        <div class="stat">Morale: <span id="statMorale">0</span></div>
        <div class="stat">Health: <span id="statHealth">0</span></div>
        <div class="stat">Day: <span id="statDay">0</span></div>
      </div>
    </header>

    <main id="main" class="panel">
      <div id="storyBox">Press START to begin.</div>

      <div class="choices" id="choicesContainer">
        <!-- choices generated here -->
      </div>

      <div class="row top-actions">
        <button id="startBtn">Start Game</button>
        <button id="saveBtn" class="choiceBtn secondary" style="display:none">Save</button>
        <button id="loadBtn" class="choiceBtn secondary" style="display:none">Load</button>
        <button id="restartBtn" class="choiceBtn secondary" style="display:none">Restart</button>
        <div style="flex:1"></div>
        <div class="small">Pro tip: Use Save before risky choices.</div>
      </div>
    </main>

    <aside class="panel" aria-live="polite">
      <div class="small"><strong>Action Log</strong></div>
      <div id="log"></div>

      <div style="height:12px"></div>
      <div class="small"><strong>Inventory</strong></div>
      <div id="inventory" class="inventory"></div>

      <div style="height:12px"></div>
      <div class="small"><strong>Progress</strong></div>
      <div>Morale<div class="bar"><i id="barMorale" style="width:0%"></i></div></div>
      <div style="margin-top:8px;">Health<div class="bar"><i id="barHealth" style="width:0%"></i></div></div>
    </aside>

    <footer class="small">Built slow & steady — choices affect story. Want expansions, more items, or a combat system? Say the word.</footer>
  </div>

<script>
/* -------- GAME CORE --------
   Single-file complete game ready to play.
   - Read code; extend by adding scenes to `SCENES` or branching in handlers.
   - Save/Load uses localStorage key 'ashes_save_v1'
*/

const SAVE_KEY = 'ashes_save_v1';

/* ---------- State ---------- */
let state = {
  day: 0,
  food: 5,
  morale: 6,
  health: 8,
  allies: 0,
  camp: false,
  path: null,       // 'smoke' or 'metro' etc
  inventory: [],    // string items
  location: 'intro',// current scene key
  alive: true,
  endingsReached: {}
};

/* ---------- Helpers ---------- */
const el = id => document.getElementById(id);
function clamp(v,a=0,b=99){ return Math.max(a,Math.min(b,Math.round(v))); }
function rnd(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }
function updateUI(){
  el('statFood').textContent = state.food;
  el('statMorale').textContent = state.morale;
  el('statHealth').textContent = state.health;
  el('statDay').textContent = state.day;
  el('barMorale').style.width = (state.morale/12*100)+'%';
  el('barHealth').style.width = (state.health/12*100)+'%';
  renderInventory();
}
function logLine(text){
  const node = document.createElement('div');
  node.style.marginBottom='6px';
  node.textContent = `[Day ${state.day}] ${text}`;
  const lg = el('log');
  lg.prepend(node);
}
function renderInventory(){
  const inv = el('inventory'); inv.innerHTML='';
  state.inventory.forEach(it=>{
    const d = document.createElement('div'); d.className='item'; d.textContent = it; inv.appendChild(d);
  });
}

/* ---------- Story / Scenes ----------
   We'll implement scenes as functions that:
   - show text via showText()
   - then call showChoices([...]) where each choice has {label, onChoose}
*/

function showText(text, preserveChoices=false){
  const box = el('storyBox');
  box.textContent = text;
  box.scrollTop = box.scrollHeight;
  if(!preserveChoices) clearChoices();
}

function clearChoices(){
  el('choicesContainer').innerHTML = '';
}

function showChoices(options){
  // options: [{label, onChoose, class}] up to many
  const container = el('choicesContainer');
  container.innerHTML = '';
  options.forEach(opt=>{
    const b = document.createElement('button');
    b.className = 'choiceBtn' + (opt.class?' '+opt.class:'');
    b.textContent = opt.label;
    b.onclick = ()=> { opt.onChoose(); };
    container.appendChild(b);
  });
}

/* ---------- Save / Load ---------- */
function saveGame(){
  localStorage.setItem(SAVE_KEY, JSON.stringify(state));
  logLine('Game saved.');
}
function loadGame(){
  const s = localStorage.getItem(SAVE_KEY);
  if(!s) { logLine('No save found.'); return; }
  try{
    state = JSON.parse(s);
    updateUI();
    runScene(state.location);
    logLine('Save loaded.');
  }catch(e){
    logLine('Failed to load save.');
  }
}

/* ---------- Utility actions ---------- */
function addItem(name){
  state.inventory.push(name);
  renderInventory();
  logLine(`Picked up: ${name}`);
}

function removeItem(name){
  const idx = state.inventory.indexOf(name);
  if(idx>=0) state.inventory.splice(idx,1);
  renderInventory();
}

function endGame(type, text){
  state.alive = false;
  state.location = 'end';
  state.endType = type;
  state.endText = text;
  state.endingsReached[type] = true;
  showText(text);
  clearChoices();
  showChoices([
    {label:'Restart Game', onChoose: () => { restartFull(); } , class:'secondary'},
    {label:'Save & Exit', onChoose: () => { saveGame(); logLine('Saved final state.'); } , class:'secondary'}
  ]);
  el('restartBtn').style.display = 'inline-block';
  updateUI();
}

/* ---------- Scenes (chapter-like) ---------- */

/* Intro cinematic -> Day 1 */
function scene_intro(){
  state.location = 'intro';
  showText("Ashes of Tomorrow\n\nYear 2137. Civilization lies in ruins.\n\nYou wake in the shell of an overturned van. Smoke stains the sky.");
  clearChoices();
  // after short pause, move to Day 1
  setTimeout(()=>{ startDay(1); runScene('day1'); }, 1400);
}

/* Start a new day (consumption + random passive) */
function startDay(dayNum){
  state.day = dayNum;
  // passive consumption
  if(state.food > 0){
    state.food = clamp(state.food - 1, 0, 99);
    logLine('You eat one rations.');
  } else {
    state.health = clamp(state.health - 2, 0, 99);
    state.morale = clamp(state.morale - 1, 0, 99);
    logLine('No food — health and morale drop.');
  }
  // small random morale shift
  if(!state.camp && rnd(1,100) < 10) state.morale = clamp(state.morale - 1);
  updateUI();
}

/* Day 1: choice between smoke and metro (base) */
function scene_day1(){
  state.location = 'day1';
  showText(
`Day ${state.day}\n
You awaken amidst the ashes. The world is quiet — too quiet.
A thin column of smoke rises to the east. To the west, the metro ruins drop into darkness.`
  );
  showChoices([
    { label: 'Head toward the smoke', onChoose: ()=> { state.path='smoke'; logLine('Chose smoke path.'); runScene('smoke1'); } },
    { label: 'Search the metro ruins', onChoose: ()=> { state.path='metro'; logLine('Chose metro path.'); runScene('metro1'); } }
  ]);
}

/* Smoke path Day1 -> Day2 */
function scene_smoke1(){
  state.location = 'smoke1';
  showText("You follow the smoke and find a burned-out camp. A carved sign reads: 'Keep moving east.'");
  showChoices([{ label:'Follow the sign east', onChoose: ()=> { runScene('smoke2'); } },
               { label:'Search the area for supplies', onChoose: ()=>{ 
                 // found minor loot
                 state.food = clamp(state.food + rnd(1,3)); addItem('Canned food'); updateUI(); runScene('smoke2');
               }}]);
}

/* Metro path Day1 -> Day2 */
function scene_metro1(){
  state.location = 'metro1';
  showText("You go down into the metro and find a torn backpack with a cracked photo and a half-eaten ration.");
  addItem('Half ration');
  showChoices([{label:'Follow tunnel deeper', onChoose: ()=> runScene('metro2')},
               {label:'Climb back to surface', onChoose: ()=> runScene('metro2')}]);
}

/* smoke2 -> encounter traveler & radio -> day3 options */
function scene_smoke2(){
  state.location = 'smoke2';
  // small chance to find an ally or danger
  const roll = rnd(1,100);
  if(roll < 60){
    showText("A wounded traveler coughs beside the road. They ask for water.");
    showChoices([
      {label:'Share water and help', onChoose: ()=>{ state.morale = clamp(state.morale + 1); addItem('Cracked radio'); logLine('Gained a cracked radio.'); runScene('day3_radio'); }},
      {label:'Ignore and move on', onChoose: ()=>{ state.morale = clamp(state.morale - 1); logLine('Ignored survivor.'); runScene('day3_radio'); }}
    ]);
  } else {
    showText("You find a small food stash but trigger a tripwire — a loud noise draws attention. You flee with food.");
    state.food = clamp(state.food + rnd(2,4)); state.health = clamp(state.health - 1);
    updateUI();
    showChoices([{label:'Keep moving east', onChoose: ()=> runScene('day3_radio')}]);
  }
}

/* metro2 -> generator map -> day3 options */
function scene_metro2(){
  state.location = 'metro2';
  showText("Deeper in the tunnels you find a generator room and a map pointing to 'Surface Entry B' and a mark: 'Safe Zone?'.");
  addItem('Map fragment');
  showChoices([{label:'Follow the map to Exit B', onChoose: ()=> runScene('day3_safezone')},
               {label:'Stay and scavenge more', onChoose: ()=>{ state.food = clamp(state.food + 1); logLine('Scavenged a little.'); runScene('day3_safezone'); }}]);
}

/* Day3 radio path */
function scene_day3_radio(){
  state.location='day3_radio';
  startDay(3);
  showText("The cracked radio sputters to life — a voice mentions a survivor camp to the north.");
  showChoices([
    {label:'Follow the signal north', onChoose: ()=> { runScene('day4_camp'); }},
    {label:'Repair the radio and wait (use time)', onChoose: ()=> { 
        // chance to repair
        if(state.inventory.includes('Cracked radio') && rnd(1,100) < 60){
           removeItem('Cracked radio'); addItem('Working radio'); logLine('Repaired the radio.');
           runScene('day4_camp');
        } else {
           logLine('Repair attempt failed; you keep trying.');
           runScene('day4_camp');
        }
    }}
  ]);
}

/* Day3 safezone path */
function scene_day3_safezone(){
  state.location='day3_safezone';
  startDay(3);
  showText("You surface near a ring of small campfires. Smoke and voices — a camp somewhere ahead.");
  showChoices([
    {label:'Approach camp cautiously', onChoose: ()=> runScene('day4_camp')},
    {label:'Observe from distance', onChoose: ()=> { state.morale = clamp(state.morale - 1); logLine('Stayed hidden; missed chance to connect.'); runScene('day4_camp'); }}
  ]);
}

/* Day4: Camp arrives (both converge here) */
function scene_day4_camp(){
  state.location='day4_camp';
  startDay(4);
  showText("You reach a survivor camp. Faces turn to you with curiosity. A woman called Mara steps forward.");
  showChoices([
    {label:'Offer to help (build trust)', onChoose: ()=> { state.morale = clamp(state.morale + 1); state.allies += 1; logLine('You helped and gained trust.'); runScene('day5_storm'); }},
    {label:'Play quiet and trade for food', onChoose: ()=> { if(state.food<3){ state.food = clamp(state.food + 2); logLine('Traded scavenged items for food.'); } else { logLine('No trade needed.'); } runScene('day5_storm'); }}
  ]);
}

/* Day5: Storm event with tough choice */
function scene_day5_storm(){
  state.location='day5_storm';
  startDay(5);
  showText("A violent storm hits. Tents tear, fires spread. Mara shouts: 'We move now!'");
  showChoices([
    {label:'Help lead survivors to high ground', onChoose: ()=> {
       // good leadership increases allies and morale
       state.allies = clamp(state.allies + 2, 0, 20);
       state.morale = clamp(state.morale + 1);
       state.food = clamp(state.food - 1);
       logLine('You led people to safety.');
       runScene('day6_dawn');
    }},
    {label:'Stay to salvage supplies (risk)', onChoose: ()=> {
       // risky: chance to be injured
       if(rnd(1,100) < 50){ state.health = clamp(state.health - 2); state.food = clamp(state.food + 2); logLine('You got hurt but saved food.'); }
       else { state.food = clamp(state.food + 1); logLine('You salvaged some supplies.'); }
       runScene('day6_dawn');
    }}
  ]);
}

/* Day6: Dawn aftermath */
function scene_day6_dawn(){
  state.location='day6_dawn';
  startDay(6);
  showText("Dawn. The storm passed. The camp is smaller, but those who survived look to you with new eyes.");
  showChoices([
    {label:'Try to organize a settlement (long-term)', onChoose: ()=> runScene('ending_rebuild')},
    {label:'Leave and keep wandering (lone path)', onChoose: ()=> runScene('ending_lone')},
    {label:'Seize power and rule by fear (dark)', onChoose: ()=> runScene('ending_chaos')}
  ]);
}

/* Endings */
function scene_ending_rebuild(){
  state.location='ending_rebuild';
  endGame('rebuild',
`Years pass. With steady work you and the survivors rebuild a small, functioning community. Fields grow. Children learn again.
Ending: Rebuild — Hope returned.`);
}
function scene_ending_lone(){
  state.location='ending_lone';
  endGame('lone',
`You leave with a small pack and a quiet heart. You survive on your wits, never settling.
Ending: Lone Survivor — freedom at a cost.`);
}
function scene_ending_chaos(){
  state.location='ending_chaos';
  endGame('chaos',
`You take control by force. The camp knows safety but lives under your harsh rule.
Ending: Warlord — power speaks louder than kindness.`);
}

/* ---------- Scene runner (map) ---------- */
const SCENES = {
  intro: scene_intro,
  day1: scene_day1,
  smoke1: scene_smoke1,
  metro1: scene_metro1,
  smoke2: scene_smoke2,
  metro2: scene_metro2,
  day3_radio: scene_day3_radio,
  day3_safezone: scene_day3_safezone,
  day4_camp: scene_day4_camp,
  day5_storm: scene_day5_storm,
  day6_dawn: scene_day6_dawn,
  ending_rebuild: scene_ending_rebuild,
  ending_lone: scene_ending_lone,
  ending_chaos: scene_ending_chaos
};

function runScene(key){
  updateUI();
  if(!state.alive) { showText("You are no longer alive. Restart to try again."); return; }
  const fn = SCENES[key];
  if(!fn){ showText("Scene not implemented: " + key); return; }
  // set location before running (so saves/calls knowledge)
  state.location = key;
  fn();
  updateUI();
}

/* ---------- Controls ---------- */
el('startBtn').addEventListener('click', ()=>{
  el('startBtn').style.display='none';
  el('saveBtn').style.display='inline-block';
  el('loadBtn').style.display='inline-block';
  el('restartBtn').style.display='inline-block';
  runScene('intro');
});
el('saveBtn').addEventListener('click', saveGame);
el('loadBtn').addEventListener('click', loadGame);
el('restartBtn').addEventListener('click', ()=>{
  if(confirm('Restart game? Current progress will be lost unless saved.')) restartFull();
});

/* ---------- Restart / New game ---------- */
function restartFull(){
  state = {
    day:0, food:5, morale:6, health:8, allies:0, camp:false, path:null, inventory:[], location:'intro', alive:true, endingsReached:{}
  };
  el('log').innerHTML='';
  renderInventory(); updateUI();
  el('startBtn').style.display='inline-block';
  el('saveBtn').style.display='none';
  el('loadBtn').style.display='none';
  el('restartBtn').style.display='none';
  el('storyBox').textContent = "Press START to begin.";
  clearChoices();
}

/* ---------- Initialize ---------- */
restartFull();

/* ---------- Auto small sanity check: if save exists, show load hint ---------- */
if(localStorage.getItem(SAVE_KEY)) {
  logLine('Save file detected. Press Load to restore.');
  el('loadBtn').style.display='inline-block';
}

</script>
</body>
</html>